
Android包管理机制 https://www.cnblogs.com/ganchuanpu/p/9313234.html


手动安装方式？
Android7.0以上包括7.0手动安装报FileUriExposedException异常？Android7.0以上包括7.0的手动安装方式？


静默安装方式？https://www.jianshu.com/p/b1691416eeae
1. 用命令行方式。pm install -r [apkFilePath]。需要系统签名或者需要root权限。
2. 引入IPackageManager相关源码。需要系统签名。
3. 通过无障碍服务？


如何提取手机系统签名文件？https://www.jianshu.com/p/326ea728e5d3
在做安装测试时，apk直接push到sdcard再安装报错？Android 10 Unable to open '/storage/emulated/0/: Permission denied？在android10，每个应用只能访问自己包名路径下的文件。
adb install 和 adb shell pm install的区别？https://stackoverflow.com/questions/28685945/difference-between-adb-install-command-and-pm-install-command


## 手动安装方式？


## 静默安装方式？
### 一、用命令行方式安装
```
pm install -r [apkFilePath]
报错：Security exception: Permission Denial: runInstallCreate from pm command asks to run as user -1 but is calling from uid u0a92; this requires android.permission.INTERACT_ACROSS_USERS_FULL
解决：需要添加 --user 0
```

```
pm install -r --user 0 [apkFilePath]
报错: Exception occurred while executing:java.lang.NullPointerException
解决：需要添加 -i [packageName]
```

```
https://blog.csdn.net/cgxzll/article/details/55224747
最终命令：pm install -r -i [packageName] --user 0 [apkFilePath]

android9.0以下不包括9.0设备报错：Failure [null] 
解决方案1：添加系统签名，即可静默安装成功。
疑问1：是否需要添加android:sharedUserId="android.uid.system"？经测试加不加都可以安装成功。
疑问2：是否需要添加INSTALL_PACKAGES权限？最好要加。跟设备有关，有的设备不加无法静默安装。

解决方案2：获取root权限？未测试。
```

```
android9.0以上包括9.0报错：Security exception: Reverse mode only supported from shell or systemjava.lang.SecurityException: Reverse mode only supported from shell or system
原因：PackageInstallerSession里做了判断。
    private void assertShellOrSystemCalling(String operation) {
        switch (Binder.getCallingUid()) {
            case android.os.Process.SHELL_UID:
            case android.os.Process.ROOT_UID:
            case android.os.Process.SYSTEM_UID:
                break;
            default:
                throw new SecurityException(operation + " only supported from shell or system");
        }
    }
https://stackoverflow.com/questions/59089567/running-shell-commands-on-android-using-runtime-getruntime
解决：需要添加android:sharedUserId="android.uid.system"。
```





